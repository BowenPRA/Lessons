<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10.1 Functions & Graphs</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&family=Plus+Jakarta+Sans:wght@400;500;700;800&family=JetBrains+Mono:wght@700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        /* --- CSS VARIABLES & THEME --- */
        :root {
            --bg-deep: #0f0518;         
            --bg-card: #1e1b2e;         
            
            --primary: #8b5cf6;   /* Violet */
            --secondary: #f43f5e; /* Rose - OUTPUTS */
            --accent: #06b6d4;    /* Cyan - INPUTS */
            --blue-bright: #38bdf8; /* Bright Blue for Date */
            --success: #10b981;   /* Emerald */
            --warning: #f59e0b;   /* Amber */

            --text-main: #ffffff;        
            --text-muted: #e2e8f0;     

            --header-h: 70px;
            --footer-h: 80px;
            --border-radius: 16px;
            
            --fs-h1: clamp(2.5rem, 5vw, 5rem);
            --fs-h2: clamp(1.8rem, 3.5vw, 3.5rem);
            --fs-h3: clamp(1.2rem, 2vw, 2rem);
            --fs-body: clamp(1.1rem, 1.2vw, 1.5rem);
        }

        /* --- RESET & BASE --- */
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-deep);
            background-image: 
                radial-gradient(circle at 15% 25%, rgba(139, 92, 246, 0.15), transparent 40%),
                radial-gradient(circle at 85% 75%, rgba(244, 63, 94, 0.1), transparent 40%),
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 100% 100%, 100% 100%, 40px 40px, 40px 40px;
            color: var(--text-main);
        }

        /* --- LAYOUT --- */
        .app-shell { display: flex; flex-direction: column; height: 100vh; }

        .header {
            height: var(--header-h);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            background: rgba(15, 5, 24, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            z-index: 10;
        }

        .brand-pill {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            padding: 0.4rem 1.2rem;
            border-radius: 50px;
            font-family: 'Outfit', sans-serif;
            font-weight: 800;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: white;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
        }

        .viewport {
            flex: 1;
            position: relative;
            overflow-y: auto;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .slide-wrapper {
            min-height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .footer {
            height: var(--footer-h);
            background: rgba(15, 5, 24, 0.95);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            z-index: 10;
        }

        /* --- COMPONENTS --- */
        .btn {
            cursor: pointer;
            border: none;
            border-radius: 12px;
            font-family: 'Outfit', sans-serif;
            font-weight: 700;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .btn:active { transform: scale(0.96); }
        
        .btn-nav {
            width: 56px;
            height: 56px;
            background: var(--bg-card);
            color: var(--text-main);
            font-size: 1.2rem;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .btn-nav:hover:not(:disabled) {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.6);
        }
        .btn-nav:disabled { opacity: 0.3; cursor: not-allowed; }

        .btn-reveal {
            background: var(--primary);
            color: white;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            width: 100%;
            margin-top: 1rem;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .btn-reveal:hover { background: #7c3aed; transform: translateY(-2px); box-shadow: 0 6px 12px rgba(139, 92, 246, 0.4); }
        
        /* Pedagogical Pills */
        .num-pill {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 60px;
            height: 60px;
            border-radius: 12px;
            font-size: 1.5rem;
            padding: 0 1rem;
            margin: 0 0.5rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }
        
        .pill-input { background: rgba(6, 182, 212, 0.25); color: var(--accent); border-color: var(--accent); }
        .pill-output { background: rgba(244, 63, 94, 0.25); color: var(--secondary); border-color: var(--secondary); }
        .pill-neutral { background: #334155; color: white; }

        .progress-container {
            flex: 1;
            margin: 0 2rem;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--accent), var(--secondary));
            transition: width 0.4s ease;
        }

        /* Typography & Layout */
        .text-center { text-align: center; }
        h1 { font-size: var(--fs-h1); font-family: 'Outfit', sans-serif; line-height: 1.1; margin-bottom: 1rem; color: white; text-shadow: 0 0 20px rgba(139, 92, 246, 0.5); }
        h2 { font-size: var(--fs-h2); font-family: 'Outfit', sans-serif; margin-bottom: 1.5rem; color: white; }
        h3 { font-size: var(--fs-h3); font-family: 'Outfit', sans-serif; margin-bottom: 1rem; color: white; }
        p, li { font-size: var(--fs-body); color: var(--text-muted); line-height: 1.6; }
        strong { color: white; font-weight: 800; }
        
        .text-accent { color: var(--accent); }
        .text-secondary { color: var(--secondary); }
        .text-primary { color: var(--primary); }

        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 3rem; align-items: center; }
        
        /* NOTEBOOK VISUAL CUE - High Visibility */
        .notebook-hint {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: rgba(139, 92, 246, 0.2); /* Tint of primary */
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: #ffffff;
            font-weight: 700;
            font-size: 1rem;
            border: 2px solid var(--primary);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
            animation: pulse-border 3s infinite;
            z-index: 5;
            backdrop-filter: blur(4px);
        }
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(139, 92, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0); }
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        /* --- FLIP CARD MECHANIC --- */
        .flip-container {
            background-color: transparent;
            perspective: 1000px;
            height: 280px; 
            cursor: pointer;
        }

        .flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        }

        .flip-container.flipped .flip-inner {
            transform: rotateY(180deg);
        }

        .flip-front, .flip-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .flip-front {
            background: var(--bg-card);
        }

        .flip-back {
            background: #2e2a45;
            transform: rotateY(180deg);
            border: 2px solid var(--primary);
        }
        
        .flip-icon { font-size: 3rem; margin-bottom: 1rem; color: var(--primary); }

        /* --- SVG STYLES --- */
        .graph-svg {
            width: 100%;
            height: auto;
            max-height: 400px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .axis { stroke: rgba(255,255,255,0.3); stroke-width: 2; }
        .grid-line { stroke: rgba(255,255,255,0.05); stroke-width: 1; }
        .graph-label { fill: var(--text-muted); font-size: 12px; font-family: 'JetBrains Mono'; }
        
        .point-target { fill: transparent; cursor: pointer; }
        .point-target:hover { fill: rgba(255, 255, 255, 0.2); }
        .point-actual { fill: var(--primary); r: 0; transition: r 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .point-actual.visible { r: 6; }
        
        .graph-line { 
            fill: none; 
            stroke: var(--success); 
            stroke-width: 3; 
            stroke-dasharray: 1000; 
            stroke-dashoffset: 1000; 
            transition: stroke-dashoffset 2s ease;
        }
        .graph-line.draw { stroke-dashoffset: 0; }

        .axis-hover-target { stroke: transparent; stroke-width: 20; cursor: pointer; }

        /* --- SPOILER & ANIMATIONS --- */
        .spoiler-content {
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.5s ease;
            pointer-events: none;
            visibility: hidden;
        }
        .spoiler-content.revealed {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
            visibility: visible;
        }

        /* Bridge Animation Classes (Initial Grid State) */
        .bridge-row { 
            transition: all 0.5s ease; 
            display: grid; 
            grid-template-columns: 1fr 1.5fr 1fr; /* Matching table-grid */
            align-items: center; 
            padding: 0.8rem; 
            border-bottom: 1px solid rgba(255,255,255,0.05); 
        }
        
        .bridge-cell {
            text-align: center;
        }

        .bridge-row.transformed { 
            display: flex; 
            justify-content: center; 
            gap: 0.2rem; 
            background: rgba(255,255,255,0.05); 
            border-radius: 8px; 
            border-bottom: none;
        }
        
        .bridge-part { transition: all 0.5s ease; }
        .bridge-part.hidden { opacity: 0; width: 0; margin: 0; }
        
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .slide-up { animation: slideUp 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; }
        .fade-in { animation: fadeIn 0.6s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Inputs */
        .input-field {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            padding: 0.8rem;
            color: white;
            font-size: 1.2rem;
            border-radius: 8px;
            width: 100px;
            text-align: center;
            font-family: 'JetBrains Mono';
        }
        .input-field:focus { border-color: var(--primary); }

        .interactive-cell {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 0.5rem;
            font-family: 'JetBrains Mono';
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
            min-width: 40px;
            min-height: 40px;
        }
        .interactive-cell:hover { background: rgba(255,255,255,0.1); border-color: var(--primary); }

        .table-grid {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 1px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 1rem;
        }
        .table-cell {
            background: var(--bg-card);
            padding: 1rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

    </style>
</head>
<body>

<div class="app-shell">
    <header class="header">
        <div style="display: flex; align-items: center; gap: 1rem;">
            <div class="brand-pill">Year 9 Math</div>
            <div style="font-family: 'Outfit'; font-weight: 700; font-size: 1.2rem; color: white;">
                10.1 Functions & Graphs
            </div>
        </div>
        
        <div style="font-size: 1.1rem; color: var(--blue-bright); font-weight: 800; font-family: 'Outfit', sans-serif;">
            Monday 19 January 2026
        </div>
    </header>

    <main class="viewport" id="viewport">
        <div id="slide-container" class="slide-wrapper" aria-live="polite">
            <!-- Slides render here -->
        </div>
    </main>

    <footer class="footer">
        <button class="btn btn-nav" id="btn-prev" aria-label="Previous Slide">
            <i class="fa-solid fa-chevron-left"></i>
        </button>
        
        <div class="progress-container">
            <div class="progress-fill" id="progress-bar"></div>
        </div>
        
        <button class="btn btn-nav" id="btn-next" aria-label="Next Slide">
            <i class="fa-solid fa-chevron-right"></i>
        </button>
    </footer>
</div>

<script>
    // Global State
    const state = {
        currentSlide: 0,
        fitnessPointsClicked: 0,
        ownPointsClicked: 0,
        slides: []
    };

    // --- SLIDE CONTENT ---
    state.slides = [
        // Slide 0: Title & Objectives (Refined per "So bad" feedback)
        {
            render: () => `
                <div class="text-center fade-in">
                    
                    <div style="font-size: 7rem; margin-bottom: 1rem; color: var(--primary); text-shadow: 0 0 40px rgba(139,92,246,0.6); animation: float 6s ease-in-out infinite;">
                        <i class="fa-solid fa-chart-line"></i>
                    </div>
                    
                    <h1 style="font-size: 4.5rem; font-weight: 800; letter-spacing: -1px; margin-bottom: 0.5rem;">
                        Functions & Graphs
                    </h1>
                    
                    <p style="font-size: 1.8rem; color: var(--secondary); font-weight: 600; margin-bottom: 3rem;">
                        Connecting Rules to Lines
                    </p>
                    
                    <div class="card slide-up" style="max-width: 800px; margin: 0 auto; text-align: left; border: 1px solid rgba(255,255,255,0.15); background: rgba(30,27,46,0.8);">
                        <ul style="list-style: none; display: grid; gap: 1.5rem;">
                            <li style="display: flex; align-items: center; gap: 1.5rem; font-size: 1.3rem; color: white;">
                                <div style="font-size: 2rem;">üîë</div>
                                <span>Define coordinates as <strong>Input (x)</strong> and <strong>Output (y)</strong>.</span>
                            </li>
                            <li style="display: flex; align-items: center; gap: 1.5rem; font-size: 1.3rem; color: white;">
                                <div style="font-size: 2rem;">üìç</div>
                                <span>Plot coordinates on a <strong>Coordinate Plane</strong>.</span>
                            </li>
                            <li style="display: flex; align-items: center; gap: 1.5rem; font-size: 1.3rem; color: white;">
                                <div style="font-size: 2rem;">üìà</div>
                                <span>Graph linear functions from real-life problems.</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <style>
                    @keyframes float {
                        0% { transform: translateY(0px); }
                        50% { transform: translateY(-15px); }
                        100% { transform: translateY(0px); }
                    }
                </style>
            `
        },

        // Slide 1: Recall (Improved Flip Cards)
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-pen"></i> Write definitions</div>
                    <h2>Key Definitions</h2>
                    <p>Tap the cards to reveal the math terms. Copy the definitions.</p>

                    <div class="grid-2 slide-up" style="gap: 2rem; margin-top: 3rem; align-items: stretch;">
                        
                        <!-- Card 1: Input -->
                        <div class="flip-container" onclick="this.classList.toggle('flipped')">
                            <div class="flip-inner">
                                <div class="flip-front">
                                    <div class="flip-icon"><i class="fa-solid fa-right-to-bracket"></i></div>
                                    <h3 class="text-accent">The Starting Number</h3>
                                    <p class="text-muted">Tap to reveal term</p>
                                </div>
                                <div class="flip-back">
                                    <h3 class="text-accent" style="margin-bottom:0.5rem; font-size: 1.8rem;">INPUT (x)</h3>
                                    <p style="font-size:1rem;">The number we put into the function.</p>
                                    <hr style="width:50%; border-color:rgba(255,255,255,0.2); margin:0.5rem 0;">
                                    <p class="text-muted" style="font-size:0.9rem;">Also called the <em>Independent Variable</em>.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Card 2: Function -->
                        <div class="flip-container" onclick="this.classList.toggle('flipped')">
                            <div class="flip-inner">
                                <div class="flip-front">
                                    <div class="flip-icon"><i class="fa-solid fa-gears"></i></div>
                                    <h3 class="text-primary">The Mathematical Rule</h3>
                                    <p class="text-muted">Tap to reveal term</p>
                                </div>
                                <div class="flip-back">
                                    <h3 class="text-primary" style="margin-bottom:0.5rem; font-size: 1.8rem;">FUNCTION</h3>
                                    <p style="font-size:1rem;">The relationship between inputs and outputs.</p>
                                    <div class="num-pill pill-neutral" style="margin-top:0.5rem; font-size:0.9rem;">y = 2x + 1</div>
                                </div>
                            </div>
                        </div>

                        <!-- Card 3: Output -->
                        <div class="flip-container" onclick="this.classList.toggle('flipped')">
                            <div class="flip-inner">
                                <div class="flip-front">
                                    <div class="flip-icon"><i class="fa-solid fa-right-from-bracket"></i></div>
                                    <h3 class="text-secondary">The Result</h3>
                                    <p class="text-muted">Tap to reveal term</p>
                                </div>
                                <div class="flip-back">
                                    <h3 class="text-secondary" style="margin-bottom:0.5rem; font-size: 1.8rem;">OUTPUT (y)</h3>
                                    <p style="font-size:1rem;">The number calculated by the rule.</p>
                                    <hr style="width:50%; border-color:rgba(255,255,255,0.2); margin:0.5rem 0;">
                                    <p class="text-muted" style="font-size:0.9rem;">Also called the <em>Dependent Variable</em>.</p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            `
        },

        // Slide 2: Connection
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-pen"></i> Write this diagram</div>
                    <h2>The Connection</h2>
                    <p>How do functions relate to graphs?</p>

                    <div class="card slide-up" style="max-width: 800px; margin: 3rem auto; padding: 3rem;">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 2rem; flex-wrap: wrap;">
                            <div style="text-align: center;">
                                <h3 class="text-accent" style="margin-bottom: 0.5rem;">Input</h3>
                                <div class="num-pill pill-input" style="width: 80px; height: 80px; font-size: 2rem;">x</div>
                            </div>
                            
                            <i class="fa-solid fa-plus" style="color: var(--text-muted);"></i>
                            
                            <div style="text-align: center;">
                                <h3 class="text-secondary" style="margin-bottom: 0.5rem;">Output</h3>
                                <div class="num-pill pill-output" style="width: 80px; height: 80px; font-size: 2rem;">y</div>
                            </div>

                            <i class="fa-solid fa-arrow-right" style="font-size: 2rem; color: white;"></i>

                            <div style="text-align: center;">
                                <h3 class="text-primary" style="margin-bottom: 0.5rem;">Coordinate</h3>
                                <div style="background: rgba(255,255,255,0.1); border: 2px solid white; border-radius: 12px; padding: 1rem 2rem; font-family: 'JetBrains Mono'; font-size: 2.5rem;">
                                    (<span class="text-accent">x</span>, <span class="text-secondary">y</span>)
                                </div>
                            </div>
                        </div>
                        
                        <p style="margin-top: 2rem; font-size: 1.3rem;">
                            The <span class="text-accent">Input</span> tells us how far <strong>Left/Right</strong>.<br>
                            The <span class="text-secondary">Output</span> tells us how far <strong>Up/Down</strong>.
                        </p>
                    </div>
                </div>
            `
        },

        // Slide 3: Tables to Coordinates
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-table"></i> Copy & Solve</div>
                    <h2>From Tables to Points</h2>
                    <p>Let's use the function: <strong class="text-primary" style="font-size: 1.4rem;">y = 2x + 1</strong></p>
                    
                    <div class="card slide-up" style="max-width: 800px; margin: 2rem auto;">
                        <div class="table-grid">
                            <div class="table-cell text-accent" style="font-weight:bold;">Input (x)</div>
                            <div class="table-cell text-primary" style="font-weight:bold;">Rule (2x + 1)</div>
                            <div class="table-cell text-secondary" style="font-weight:bold;">Output (y)</div>
                        </div>

                        <!-- Row 0 -->
                        <div class="bridge-row" id="row-0">
                            <div class="bridge-cell bridge-part text-accent" style="font-size: 1.2rem;">0</div>
                            <div class="bridge-cell bridge-part text-primary">2(0) + 1</div>
                            <div class="bridge-cell bridge-part text-secondary" style="font-size: 1.2rem;">1</div>
                        </div>

                        <!-- Row 1 -->
                        <div class="bridge-row" id="row-1">
                            <div class="bridge-cell bridge-part text-accent" style="font-size: 1.2rem;">1</div>
                            <div class="bridge-cell bridge-part text-primary">2(1) + 1</div>
                            <div class="bridge-cell bridge-part text-secondary" style="font-size: 1.2rem;">3</div>
                        </div>

                        <!-- Row 2 -->
                        <div class="bridge-row" id="row-2">
                            <div class="bridge-cell bridge-part text-accent" style="font-size: 1.2rem;">2</div>
                            <div class="bridge-cell bridge-part text-primary">2(2) + 1</div>
                            <div class="bridge-cell bridge-part text-secondary" style="font-size: 1.2rem;">5</div>
                        </div>

                        <!-- Row 3 -->
                        <div class="bridge-row" id="row-3">
                            <div class="bridge-cell bridge-part text-accent" style="font-size: 1.2rem;">3</div>
                            <div class="bridge-cell bridge-part text-primary">2(3) + 1</div>
                            <div class="bridge-cell bridge-part text-secondary" style="font-size: 1.2rem;">7</div>
                        </div>

                        <button class="btn btn-reveal" id="transform-btn" onclick="transformAllRows()" style="width: auto; margin: 2rem auto;">
                            Convert to Coordinates
                        </button>
                        
                        <p id="bridge-expl" class="spoiler-content" style="margin-top: 2rem; color: var(--success); font-weight: bold;">
                            Coordinates are written as ordered pairs: (x, y)
                        </p>
                    </div>
                </div>
            `
        },

        // Slide 4: The Coordinate Plane
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-pencil"></i> Draw axes & Plot</div>
                    <h2>The Coordinate Plane</h2>
                    <p>Plotting the points from: <strong class="text-primary">y = 2x + 1</strong></p>
                    
                    <div class="grid-2 slide-up" style="margin-top: 2rem; align-items: start;">
                        
                        <!-- SVG Plane -->
                        <div class="card" style="padding: 1rem;">
                            <svg class="graph-svg" viewBox="-10 -10 320 320" style="background: #111;">
                                <!-- Grid -->
                                <pattern id="grid" width="30" height="30" patternUnits="userSpaceOnUse">
                                    <path d="M 30 0 L 0 0 0 30" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/>
                                </pattern>
                                <rect width="100%" height="100%" fill="url(#grid)" />
                                
                                <!-- Axes -->
                                <line x1="20" y1="280" x2="280" y2="280" stroke="white" stroke-width="2" marker-end="url(#arrow)" />
                                <line x1="20" y1="280" x2="20" y2="20" stroke="white" stroke-width="2" marker-end="url(#arrow)" />
                                
                                <!-- Arrow Def -->
                                <defs>
                                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#fff" />
                                    </marker>
                                </defs>
                                
                                <!-- Axis Labels -->
                                <text x="20" y="295" class="graph-label">0</text>
                                <text x="80" y="295" class="graph-label">1</text>
                                <text x="140" y="295" class="graph-label">2</text>
                                <text x="200" y="295" class="graph-label">3</text>
                                
                                <text x="5" y="250" class="graph-label">1</text>
                                <text x="5" y="190" class="graph-label">3</text>
                                <text x="5" y="130" class="graph-label">5</text>
                                <text x="5" y="70" class="graph-label">7</text>

                                <!-- Points -->
                                <g id="plot-group" style="opacity:0; transition: opacity 1s;">
                                    <circle cx="20" cy="250" r="6" fill="var(--primary)" />
                                    <text x="30" y="250" fill="white" font-size="12">(0,1)</text>

                                    <circle cx="80" cy="190" r="6" fill="var(--primary)" />
                                    <text x="90" y="190" fill="white" font-size="12">(1,3)</text>

                                    <circle cx="140" cy="130" r="6" fill="var(--primary)" />
                                    <text x="150" y="130" fill="white" font-size="12">(2,5)</text>

                                    <circle cx="200" cy="70" r="6" fill="var(--primary)" />
                                    <text x="210" y="70" fill="white" font-size="12">(3,7)</text>

                                    <!-- Line -->
                                    <line x1="20" y1="250" x2="200" y2="70" stroke="var(--success)" stroke-width="2" />
                                </g>

                                <text x="270" y="310" fill="white" font-family="Outfit">x</text>
                                <text x="10" y="15" fill="white" font-family="Outfit">y</text>
                            </svg>
                            <button class="btn btn-nav" style="width: 100%; margin-top: 1rem;" onclick="document.getElementById('plot-group').style.opacity = '1';">
                                Reveal Points
                            </button>
                        </div>

                        <!-- Explanation -->
                        <div class="card" style="text-align: left;">
                            <h3 class="text-accent">Coordinates</h3>
                            <ul style="list-style: none; display: flex; flex-direction: column; gap: 1rem;">
                                <li style="background: rgba(255,255,255,0.05); padding: 0.5rem; border-radius: 8px;">(0, 1)</li>
                                <li style="background: rgba(255,255,255,0.05); padding: 0.5rem; border-radius: 8px;">(1, 3)</li>
                                <li style="background: rgba(255,255,255,0.05); padding: 0.5rem; border-radius: 8px;">(2, 5)</li>
                                <li style="background: rgba(255,255,255,0.05); padding: 0.5rem; border-radius: 8px;">(3, 7)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `
        },

        // Slide 5: Real Life Example (Fitness Club)
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-calculator"></i> Copy problem</div>
                    <span class="brand-pill" style="background: var(--success);">Real Life Math</span>
                    <h2 style="margin-top: 1rem;">The Fitness Club</h2>
                    
                    <div class="card slide-up" style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; gap: 2rem; align-items: center; justify-content: center; margin-bottom: 2rem;">
                            <i class="fa-solid fa-dumbbell" style="font-size: 4rem; color: var(--accent);"></i>
                            <div style="text-align: left;">
                                <p style="font-size: 1.4rem;">Joining Fee: <strong class="text-warning">$20</strong></p>
                                <p style="font-size: 1.4rem;">Weekly Cost: <strong class="text-primary">$15 / week</strong></p>
                            </div>
                        </div>

                        <div style="background: rgba(0,0,0,0.2); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem;">
                            <p>How much for <strong>4 weeks</strong>?</p>
                            <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; margin-top: 1rem;">
                                <span>( 15 √ó 4 ) + 20 = </span>
                                <input type="number" id="fit-input" class="input-field" placeholder="?">
                                <button class="btn btn-nav btn-sm" onclick="checkFitness()">Check</button>
                            </div>
                            <p id="fit-feedback" style="height: 1.5rem; margin-top: 0.5rem; color: var(--success); font-weight: bold;"></p>
                        </div>

                        <button class="btn btn-reveal" id="fit-reveal-btn" onclick="document.getElementById('fit-formula').classList.add('revealed')" disabled>
                            Reveal Function Rule
                        </button>

                        <div id="fit-formula" class="spoiler-content" style="margin-top: 2rem;">
                            <h3 style="font-family: 'JetBrains Mono'; font-size: 2rem;">
                                <span class="text-secondary">C</span> = 15<span class="text-accent">w</span> + 20
                            </h3>
                            <p class="text-muted">(Cost = 15 √ó weeks + 20)</p>
                        </div>
                    </div>
                </div>
            `
        },

        // Slide 6: Plotting the Fitness Graph
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-pencil"></i> Sketch graph</div>
                    <h2>Plot the Fitness Graph</h2>
                    <p>Click the grid to plot these 3 points:</p>
                    <div style="display: flex; gap: 1rem; justify-content: center; margin: 1rem 0;">
                        <div class="num-pill pill-neutral" id="pt-0">(0, 20)</div>
                        <div class="num-pill pill-neutral" id="pt-1">(1, 35)</div>
                        <div class="num-pill pill-neutral" id="pt-2">(2, 50)</div>
                    </div>

                    <div class="card slide-up" style="max-width: 600px; margin: 0 auto; padding: 1rem;">
                        <svg class="graph-svg" viewBox="-20 -20 340 340" style="overflow: visible;">
                            <!-- Axes -->
                            <line x1="20" y1="300" x2="320" y2="300" class="axis" /> <!-- X -->
                            <line x1="20" y1="300" x2="20" y2="0" class="axis" />   <!-- Y -->
                            
                            <!-- Labels -->
                            <text x="320" y="320" fill="white">Weeks (x)</text>
                            <text x="0" y="-10" fill="white">Cost (y)</text>
                            
                            <text x="20" y="320" class="graph-label">0</text>
                            <text x="120" y="320" class="graph-label">1</text>
                            <text x="220" y="320" class="graph-label">2</text>
                            
                            <text x="0" y="305" class="graph-label">0</text>
                            <text x="0" y="225" class="graph-label">20</text>
                            <text x="0" y="105" class="graph-label">50</text>

                            <!-- Line -->
                            <line x1="20" y1="220" x2="220" y2="100" class="graph-line" id="fitness-line" />

                            <!-- Interactive Points -->
                            <circle cx="20" cy="220" r="15" class="point-target" onclick="plotPoint(0, this)" />
                            <circle cx="20" cy="220" r="0" class="point-actual" id="dot-0" />

                            <circle cx="120" cy="160" r="15" class="point-target" onclick="plotPoint(1, this)" />
                            <circle cx="120" cy="160" r="0" class="point-actual" id="dot-1" />

                            <circle cx="220" cy="100" r="15" class="point-target" onclick="plotPoint(2, this)" />
                            <circle cx="220" cy="100" r="0" class="point-actual" id="dot-2" />
                        </svg>
                        <p id="plot-feedback" style="margin-top: 1rem; color: var(--text-muted); min-height: 1.5rem;"></p>
                    </div>
                </div>
            `
        },

        // Slide 7: NEW "On Your Own"
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-bolt"></i> Solve in book</div>
                    <span class="brand-pill" style="background: var(--primary);">On Your Own</span>
                    <h2>Taxi Fare Problem</h2>
                    <p>A taxi charges <strong class="text-warning">$5 to start</strong> and <strong class="text-primary">$2 per km</strong>.</p>
                    
                    <div class="grid-2 slide-up" style="gap: 2rem;">
                        <div class="card">
                            <h3>1. Write the Function</h3>
                            <div style="margin: 2rem 0; font-size: 1.5rem; font-family: 'JetBrains Mono';">
                                y = <input type="text" id="taxi-m" class="input-field" style="width: 60px;" placeholder="m">x + <input type="text" id="taxi-c" class="input-field" style="width: 60px;" placeholder="c">
                            </div>
                            <button class="btn btn-nav btn-sm" onclick="checkTaxiFunc()">Check Rule</button>
                            <p id="taxi-feedback" style="margin-top:1rem; height:1.5rem; font-weight:bold;"></p>
                        </div>

                        <div class="card">
                            <h3>2. Plot 3 Points</h3>
                            <p style="font-size:0.9rem; color:var(--text-muted); margin-bottom:1rem;">Plot for x=0, x=1, x=2</p>
                            <svg class="graph-svg" viewBox="-20 -20 250 250" style="overflow: visible;">
                                <!-- Axes -->
                                <line x1="20" y1="200" x2="220" y2="200" class="axis" />
                                <line x1="20" y1="200" x2="20" y2="0" class="axis" />
                                
                                <text x="220" y="220" fill="white" font-size="12">km (x)</text>
                                <text x="0" y="-10" fill="white" font-size="12">Cost (y)</text>
                                
                                <text x="20" y="220" class="graph-label">0</text>
                                <text x="100" y="220" class="graph-label">1</text>
                                <text x="180" y="220" class="graph-label">2</text>
                                
                                <text x="0" y="105" class="graph-label">5</text>
                                <text x="0" y="25" class="graph-label">9</text>

                                <line x1="20" y1="100" x2="180" y2="20" class="graph-line" id="taxi-line" />

                                <circle cx="20" cy="100" r="15" class="point-target" onclick="plotTaxi(0, this)" />
                                <circle cx="20" cy="100" r="0" class="point-actual" id="taxi-dot-0" />

                                <circle cx="100" cy="60" r="15" class="point-target" onclick="plotTaxi(1, this)" />
                                <circle cx="100" cy="60" r="0" class="point-actual" id="taxi-dot-1" />

                                <circle cx="180" cy="20" r="15" class="point-target" onclick="plotTaxi(2, this)" />
                                <circle cx="180" cy="20" r="0" class="point-actual" id="taxi-dot-2" />
                            </svg>
                        </div>
                    </div>
                </div>
            `
        },

        // Slide 8: Decreasing Graph (Improved)
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-pen"></i> Write values & sketch</div>
                    <span class="brand-pill" style="background: var(--warning);">Different Shape</span>
                    <h2>A Decreasing Function</h2>
                    <p>Rule: <strong class="text-warning" style="font-size:1.5rem;">y = 20 - x</strong></p>
                    
                    <div class="grid-2 slide-up" style="gap: 2rem; margin-top: 2rem;">
                        <!-- Table Activity -->
                        <div class="card">
                            <h3>Complete the Table</h3>
                            <table style="width: 100%; border-spacing: 0.5rem; border-collapse: separate;">
                                <tr>
                                    <th class="text-accent">x</th>
                                    <td><div class="num-pill pill-input" style="font-size:1.1rem; width:40px; height:40px;">0</div></td>
                                    <td><div class="num-pill pill-input" style="font-size:1.1rem; width:40px; height:40px;">5</div></td>
                                    <td><div class="num-pill pill-input" style="font-size:1.1rem; width:40px; height:40px;">10</div></td>
                                    <td><div class="num-pill pill-input" style="font-size:1.1rem; width:40px; height:40px;">15</div></td>
                                    <td><div class="num-pill pill-input" style="font-size:1.1rem; width:40px; height:40px;">20</div></td>
                                </tr>
                                <tr>
                                    <th class="text-secondary">y</th>
                                    <td><div class="num-pill pill-output" style="font-size:1.1rem; width:40px; height:40px;">20</div></td>
                                    <td><button class="interactive-cell" onclick="solveDec(this, 15)">?</button></td>
                                    <td><button class="interactive-cell" onclick="solveDec(this, 10)">?</button></td>
                                    <td><button class="interactive-cell" onclick="solveDec(this, 5)">?</button></td>
                                    <td><button class="interactive-cell" onclick="solveDec(this, 0)">?</button></td>
                                </tr>
                            </table>
                        </div>

                        <!-- Graph Reveal -->
                        <div class="card spoiler-content" id="dec-graph-card">
                            <h3>The Graph</h3>
                            <svg class="graph-svg" viewBox="-20 -20 240 240" style="overflow:visible;">
                                <!-- Axes -->
                                <line x1="20" y1="200" x2="220" y2="200" stroke="white" stroke-width="2" marker-end="url(#arrow)" />
                                <line x1="20" y1="200" x2="20" y2="0" stroke="white" stroke-width="2" marker-end="url(#arrow)" />
                                
                                <text x="220" y="220" fill="white">x</text>
                                <text x="0" y="-10" fill="white">y</text>
                                
                                <text x="20" y="220" class="graph-label">0</text>
                                <text x="70" y="220" class="graph-label">5</text>
                                <text x="120" y="220" class="graph-label">10</text>
                                <text x="220" y="220" class="graph-label">20</text>

                                <text x="5" y="200" class="graph-label">0</text>
                                <text x="5" y="110" class="graph-label">10</text>
                                <text x="5" y="20" class="graph-label">20</text>

                                <!-- The Line (Going Down) -->
                                <line x1="20" y1="20" x2="220" y2="200" stroke="#f59e0b" stroke-width="3" />
                                
                                <!-- (0, 20) -->
                                <circle cx="20" cy="20" r="4" fill="white" />
                                <text x="30" y="20" fill="white" font-size="10">(0,20)</text> 
                                
                                <!-- (20, 0) -->
                                <circle cx="220" cy="200" r="4" fill="white" /> 
                                <text x="220" y="230" fill="white" font-size="10">(20,0)</text>

                                <text x="120" y="50" fill="var(--warning)" font-weight="bold">Going Down!</text>
                            </svg>
                            <p>As x increases, y decreases.</p>
                        </div>
                    </div>
                </div>
            `
        },

        // Slide 9: Assessment
        {
            render: () => `
                <div class="fade-in text-center">
                    <div class="notebook-hint"><i class="fa-solid fa-question"></i> Write question</div>
                    <span class="brand-pill" style="background: var(--primary);">Assessment</span>
                    <h2>Is the point on the line?</h2>
                    
                    <div class="card slide-up" style="max-width: 700px; margin: 2rem auto;">
                        <p style="font-size: 1.4rem; margin-bottom: 1rem;">
                            Line Equation: <strong class="text-primary">y = 2x + 5</strong>
                        </p>
                        <p style="font-size: 1.2rem; margin-bottom: 2rem;">
                            Is the point <strong class="text-accent">(10, 30)</strong> on this line?
                        </p>
                        
                        <div style="display: flex; gap: 1rem; justify-content: center;">
                            <button class="btn btn-nav" style="width: 100px; height: 60px; font-weight: bold; border-radius: 12px;" onclick="checkAssessment(true)">Yes</button>
                            <button class="btn btn-nav" style="width: 100px; height: 60px; font-weight: bold; border-radius: 12px;" onclick="checkAssessment(false)">No</button>
                        </div>

                        <div id="assess-feedback" class="spoiler-content" style="margin-top: 2rem; text-align: left; background: rgba(0,0,0,0.3); padding: 1.5rem; border-radius: 12px;">
                            <!-- Feedback injected here -->
                        </div>
                        
                        <!-- Level Up Section -->
                        <div id="assess-levelup" class="spoiler-content" style="margin-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 2rem;">
                            <h3>Challenge: Which point IS on the line?</h3>
                            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">
                                <button class="num-pill pill-neutral" style="width: auto; padding: 0 1rem; cursor: pointer;" onclick="checkPoint(this, 3, 11)">A. (3, 11)</button>
                                <button class="num-pill pill-neutral" style="width: auto; padding: 0 1rem; cursor: pointer;" onclick="checkPoint(this, 4, 12)">B. (4, 12)</button>
                                <button class="num-pill pill-neutral" style="width: auto; padding: 0 1rem; cursor: pointer;" onclick="checkPoint(this, 0, 4)">C. (0, 4)</button>
                            </div>
                            <p id="point-feedback" style="margin-top:1rem; font-weight:bold;"></p>
                        </div>
                    </div>
                </div>
            `
        },

        // Slide 10: Summary
        {
            render: () => `
                <div class="text-center fade-in">
                    <h2>üìù Summary & Homework</h2>
                    <div class="card slide-up" style="max-width: 600px; margin: 2rem auto; text-align: left;">
                        <ul style="list-style: none; font-size: 1.2rem; display: grid; gap: 1.5rem;">
                            <li style="display: flex; gap: 1rem; align-items: center;">
                                <i class="fa-solid fa-square-check" style="color: var(--success);"></i>
                                <span><strong>Inputs (x)</strong> are horizontal, <strong>Outputs (y)</strong> are vertical.</span>
                            </li>
                            <li style="display: flex; gap: 1rem; align-items: center;">
                                <i class="fa-solid fa-square-check" style="color: var(--success);"></i>
                                <span>Linear graphs form <strong>straight lines</strong>.</span>
                            </li>
                            <li style="display: flex; gap: 1rem; align-items: center;">
                                <i class="fa-solid fa-square-check" style="color: var(--success);"></i>
                                <span>To check a point, <strong>substitute</strong> x into the rule.</span>
                            </li>
                        </ul>
                        
                        <hr style="border-color: rgba(255,255,255,0.1); margin: 2rem 0;">
                        
                        <div style="text-align: center;">
                            <h3 class="text-accent">Homework</h3>
                            <p>Workbook 10.1 & 10.2: All Problems</p>
                        </div>
                    </div>
                </div>
            `
        }
    ];

    // --- INTERACTIVE LOGIC ---

    // Slide 3: Row Transformation
    function transformAllRows() {
        ['row-0', 'row-1', 'row-2', 'row-3'].forEach((id, index) => {
            setTimeout(() => {
                const row = document.getElementById(id);
                // Extract values (simplified for demo logic)
                const xVal = index; 
                const yVal = 2*index + 1;
                
                row.innerHTML = `
                    <div class="bridge-part text-muted" style="font-size: 2rem;">(</div>
                    <div class="bridge-part text-accent" style="font-size: 2rem;">${xVal}</div>
                    <div class="bridge-part text-muted" style="font-size: 2rem;">,</div>
                    <div class="bridge-part text-secondary" style="font-size: 2rem;">${yVal}</div>
                    <div class="bridge-part text-muted" style="font-size: 2rem;">)</div>
                `;
                row.classList.add('transformed');
            }, index * 500);
        });
        
        document.getElementById('transform-btn').style.display = 'none';
        document.getElementById('bridge-expl').classList.add('revealed');
    }

    // Slide 5: Fitness Check
    function checkFitness() {
        const val = document.getElementById('fit-input').value;
        const feedback = document.getElementById('fit-feedback');
        const btn = document.getElementById('fit-reveal-btn');
        
        if (val == 80) {
            feedback.innerText = "Correct! $80";
            btn.disabled = false;
            btn.classList.add('slide-up');
        } else {
            feedback.innerText = "Try again. 15 * 4 = 60...";
            feedback.style.color = "var(--secondary)";
            setTimeout(() => { feedback.style.color = "var(--success)"; feedback.innerText = ""; }, 2000);
        }
    }

    // Slide 6: Plotting
    function plotPoint(idx, target) {
        if (target.getAttribute('data-clicked')) return;
        target.setAttribute('data-clicked', 'true');
        
        document.getElementById(`dot-${idx}`).classList.add('visible');
        document.getElementById(`pt-${idx}`).classList.remove('pill-neutral');
        document.getElementById(`pt-${idx}`).classList.add('pill-output');
        
        state.fitnessPointsClicked++;
        
        if (state.fitnessPointsClicked === 3) {
            document.getElementById('fitness-line').classList.add('draw');
            document.getElementById('plot-feedback').innerText = "Excellent! The line represents all possible costs.";
            document.getElementById('plot-feedback').style.color = "var(--success)";
        }
    }

    // Slide 7: Taxi Logic
    function checkTaxiFunc() {
        const m = document.getElementById('taxi-m').value;
        const c = document.getElementById('taxi-c').value;
        const fb = document.getElementById('taxi-feedback');
        
        if (m == '2' && c == '5') {
            fb.innerText = "Correct! y = 2x + 5";
            fb.style.color = "var(--success)";
        } else {
            fb.innerText = "Not quite. Look at the costs again.";
            fb.style.color = "var(--secondary)";
        }
    }

    function plotTaxi(idx, target) {
        if (target.getAttribute('data-clicked')) return;
        target.setAttribute('data-clicked', 'true');
        
        document.getElementById(`taxi-dot-${idx}`).classList.add('visible');
        
        state.ownPointsClicked++;
        
        if (state.ownPointsClicked === 3) {
            document.getElementById('taxi-line').classList.add('draw');
        }
    }

    // Slide 8: Decreasing
    function solveDec(btn, correctVal) {
        btn.innerText = correctVal;
        btn.style.background = 'rgba(16, 185, 129, 0.2)';
        btn.style.borderColor = 'var(--success)';
        
        // Check if all are solved (simple check: if graph is hidden, reveal it)
        const card = document.getElementById('dec-graph-card');
        if (!card.classList.contains('revealed')) {
             card.classList.add('revealed');
        }
    }

    // Slide 9: Assessment
    function checkAssessment(isYes) {
        const feedback = document.getElementById('assess-feedback');
        feedback.classList.add('revealed');
        
        if (!isYes) {
            feedback.innerHTML = `
                <h3 class="text-success">Correct!</h3>
                <p>If x = 10, then y should be:</p>
                <p>y = 2(10) + 5 = <strong>25</strong></p>
                <p>Since 30 ‚â† 25, the point is <strong class="text-secondary">OFF</strong> the track.</p>
            `;
            setTimeout(() => {
                document.getElementById('assess-levelup').classList.add('revealed');
            }, 2000);
        } else {
            feedback.innerHTML = `
                <h3 class="text-secondary">Incorrect</h3>
                <p>Check by substitution:</p>
                <p>Does 30 = 2(10) + 5?</p>
                <p>30 = 20 + 5</p>
                <p>30 = 25 ... <strong>False</strong></p>
            `;
        }
    }

    function checkPoint(btn, x, y) {
        const expected = 2*x + 5;
        const fb = document.getElementById('point-feedback');
        
        if (y === expected) {
            btn.classList.remove('pill-neutral');
            btn.classList.add('pill-output');
            btn.style.borderColor = 'var(--success)';
            btn.style.background = 'rgba(16, 185, 129, 0.2)';
            fb.innerText = `Correct! 2(${x}) + 5 = ${y}`;
            fb.style.color = 'var(--success)';
        } else {
            btn.style.borderColor = 'var(--secondary)';
            fb.innerText = `Incorrect. 2(${x}) + 5 = ${expected}, not ${y}`;
            fb.style.color = 'var(--secondary)';
        }
    }

    // --- CORE RENDER ENGINE ---
    function render() {
        const container = document.getElementById('slide-container');
        const slide = state.slides[state.currentSlide];
        container.innerHTML = slide.render();
        
        // Update Progress
        const percent = ((state.currentSlide + 1) / state.slides.length) * 100;
        document.getElementById('progress-bar').style.width = `${percent}%`;
        
        // Nav Buttons
        document.getElementById('btn-prev').disabled = state.currentSlide === 0;
        document.getElementById('btn-next').disabled = state.currentSlide === state.slides.length - 1;
        
        // Reset local slide state logic
        if(state.currentSlide === 6) state.fitnessPointsClicked = 0; 
        if(state.currentSlide === 7) state.ownPointsClicked = 0;
    }

    function changeSlide(dir) {
        const next = state.currentSlide + dir;
        if (next >= 0 && next < state.slides.length) {
            state.currentSlide = next;
            render();
        }
    }

    // Bind Events
    document.getElementById('btn-prev').addEventListener('click', () => changeSlide(-1));
    document.getElementById('btn-next').addEventListener('click', () => changeSlide(1));

    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight') changeSlide(1);
        if (e.key === 'ArrowLeft') changeSlide(-1);
    });

    // Init
    render();

</script>
</body>
</html>
