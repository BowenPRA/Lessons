<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7.3 Growth, Development & Health | Year 8 Science</title>
    
    <!-- Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&family=Plus+Jakarta+Sans:wght@500;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- MathJax for formulas -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            /* --- COLOR PALETTE (Cambridge Science Theme) --- */
            --bg-deep: #0f172a;    /* Deep Slate */
            --bg-panel: #1e293b;
            --primary: #8b5cf6;    /* Chemical Purple */
            --primary-hover: #7c3aed;
            --accent: #10b981;     /* Acid Green */
            --warning: #f59e0b;    /* Hazard Orange */
            --danger: #ef4444;     /* Heat Red */
            --text-light: #f1f5f9;
            --text-dim: #94a3b8;
            
            /* --- SIZING TOKENS --- */
            --header-h: 80px;
            --footer-h: 90px;
            --radius: 24px;
        }

        /* --- RESET & BASE --- */
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-light);
            height: 100vh;
            width: 100vw;
            overflow: hidden; 
            display: flex;
            flex-direction: column;
        }

        /* Accessibility: Focus Indicators */
        :focus-visible {
            outline: 3px solid var(--accent);
            outline-offset: 4px;
            border-radius: 4px;
        }

        /* --- BACKGROUND ANIMATION LAYER --- */
        #bg-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            opacity: 0.3;
            pointer-events: none;
        }

        /* --- TYPOGRAPHY --- */
        h1 { font-family: 'Outfit'; font-weight: 900; font-size: clamp(2.5rem, 5vw, 5rem); line-height: 1.1; letter-spacing: -2px; }
        h2 { font-family: 'Outfit'; font-weight: 800; font-size: clamp(2rem, 4vw, 3.5rem); margin-bottom: 1rem; color: white; }
        h3 { font-family: 'Outfit'; font-weight: 700; font-size: clamp(1.5rem, 2.5vw, 2rem); color: var(--primary); }
        p, li { font-size: clamp(1.1rem, 1.5vw, 1.4rem); line-height: 1.6; color: #cbd5e1; }
        
        .highlight-accent { color: var(--accent); text-shadow: 0 0 20px rgba(16, 185, 129, 0.4); }
        .highlight-primary { color: var(--primary); }
        .highlight-warn { color: var(--warning); }
        .highlight-danger { color: var(--danger); text-shadow: 0 0 20px rgba(239, 68, 68, 0.4); }

        /* --- LAYOUT SHELL --- */
        header {
            height: var(--header-h);
            flex-shrink: 0; 
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }

        .tag {
            background: rgba(255,255,255,0.1);
            padding: 0.5rem 1.5rem;
            border-radius: 100px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1rem;
            border: 1px solid rgba(255,255,255,0.2);
        }

        main {
            flex: 1;
            position: relative;
            padding: 1rem 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--bg-deep);
        }

        .slide-container {
            width: 100%;
            max-width: 1400px; 
            margin: auto 0; 
            min-height: min-content;
        }

        footer {
            height: var(--footer-h);
            flex-shrink: 0;
            background: rgba(15, 23, 42, 0.95);
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-top: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }

        /* --- PEDAGOGICAL NOTE BOX --- */
        .pedagogical-note {
            position: relative;
            background: rgba(30, 41, 59, 0.8);
            border: 3px solid var(--accent); 
            border-left-width: 12px; 
            border-radius: 16px;
            padding: 2rem;
            margin: 1.5rem 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .pedagogical-badge {
            position: absolute;
            top: -18px;
            left: 20px;
            background: var(--accent);
            color: #000;
            padding: 0.4rem 1.2rem;
            border-radius: 50px;
            font-weight: 900;
            text-transform: uppercase;
            font-size: 0.9rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: 1px;
        }

        .note-write { border-color: var(--primary); }
        .note-write .pedagogical-badge { background: var(--primary); color: white; }

        .note-task { border-color: var(--warning); }
        .note-task .pedagogical-badge { background: var(--warning); color: black; }

        .note-success { border-color: var(--accent); }
        .note-success .pedagogical-badge { background: var(--accent); color: black; }
        
        .note-theory { border-color: var(--danger); }
        .note-theory .pedagogical-badge { background: var(--danger); color: white; }


        /* --- CARDS & GRIDS --- */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; }
        
        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            border: 2px solid rgba(255,255,255,0.08);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: 0 20px 50px -10px rgba(0,0,0,0.5);
            transition: transform 0.3s ease, border-color 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .glass-card:hover { border-color: rgba(255,255,255,0.2); }

        /* --- INTERACTIVE ELEMENTS --- */
        .reveal-card {
            background: var(--bg-panel);
            border: 2px dashed var(--text-dim);
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            border-radius: 16px;
            transition: all 0.3s ease;
            height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .reveal-card:hover, .reveal-card:focus { border-color: var(--accent); background: rgba(16, 185, 129, 0.1); }
        .reveal-card.revealed {
            border-style: solid;
            border-color: var(--accent);
            background: var(--bg-panel);
            cursor: default;
        }
        .reveal-content { display: none; animation: popIn 0.3s forwards; }
        .reveal-icon { font-size: 3rem; margin-bottom: 1rem; color: var(--text-dim); }

        /* --- CONTROLS --- */
        .btn-nav {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            width: 50px; height: 50px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex; align-items: center; justify-content: center;
        }
        .btn-nav:hover:not(:disabled) { background: var(--primary); transform: scale(1.1); }
        .btn-nav:disabled { opacity: 0.2; cursor: not-allowed; }

        .btn-action {
            background: var(--primary);
            color: white;
            border: none;
            padding: 1rem 2rem;
            font-size: 1.2rem;
            font-weight: 800;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
            transition: all 0.2s;
            font-family: 'Outfit';
            text-transform: uppercase;
        }
        .btn-action:hover, .btn-action:focus { transform: translateY(-3px); box-shadow: 0 0 40px rgba(139, 92, 246, 0.6); background: var(--primary-hover); }
        .btn-action:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none; background: #64748b; }

        .progress-track {
            flex: 1; margin: 0 2rem; height: 8px;
            background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;
        }
        .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1); }

        /* --- ANIMATIONS --- */
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.95) translateY(10px); } 100% { opacity: 1; transform: scale(1) translateY(0); } }
        
        .anim-enter { animation: popIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; }
        
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }

        /* --- QUIZ STYLES --- */
        .quiz-option {
            background: rgba(255,255,255,0.05);
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 0.8rem;
            cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid transparent;
        }
        .quiz-option:hover, .quiz-option:focus { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2); }
        .quiz-option.correct { background: rgba(16, 185, 129, 0.2); border-color: var(--accent); }
        .quiz-option.wrong { background: rgba(239, 68, 68, 0.2); border-color: var(--danger); }

        /* Chart Bars */
        .chart-container { display: flex; align-items: flex-end; justify-content: space-around; height: 300px; padding: 20px; background: rgba(0,0,0,0.2); border-radius: 12px; position: relative; }
        .chart-bar { width: 50px; background: var(--primary); transition: height 1s cubic-bezier(0.16, 1, 0.3, 1); position: relative; border-radius: 8px 8px 0 0; }
        .chart-bar:hover { background: var(--accent); cursor: help; }
        .chart-bar:hover::after {
            content: attr(data-val);
            position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
            background: white; color: black; padding: 4px 8px; border-radius: 4px; font-weight: bold;
        }
        .chart-label { position: absolute; bottom: -30px; left: 50%; transform: translateX(-50%); width: 100px; text-align: center; font-size: 0.8rem; }

        @media (max-width: 1000px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; gap: 2rem; }
            h1 { font-size: 3rem; }
            .pedagogical-note { padding: 1.5rem; }
            .btn-nav { width: 44px; height: 44px; }
        }
    </style>
</head>
<body>

    <!-- Background Canvas -->
    <canvas id="bg-canvas"></canvas>

    <header>
        <div style="display:flex; align-items:center; gap:1rem;">
            <i class="fa-solid fa-dna" style="color:var(--primary); font-size:1.5rem;"></i>
            <span style="font-weight:700; letter-spacing:1px; font-size: 1.5rem;">Year 8 Science</span>
        </div>
        <div class="tag">Unit 7.3 Growth</div>
    </header>

    <main>
        <div id="slide-viewer" class="slide-container" aria-live="polite">
            <!-- Slides inject here -->
        </div>
    </main>

    <footer>
        <button class="btn-nav" id="btn-prev" aria-label="Previous Slide"><i class="fa-solid fa-chevron-left"></i></button>
        <div class="progress-track">
            <div id="progress-bar" class="progress-fill"></div>
        </div>
        <button class="btn-nav" id="btn-next" aria-label="Next Slide"><i class="fa-solid fa-chevron-right"></i></button>
    </footer>

<script>
/**
 * @class BackgroundAnimation
 * @description Manages floating DNA and Cell particles.
 */
class BackgroundAnimation {
    constructor(canvasId) {
        this.canvas = document.getElementById(canvasId);
        this.ctx = this.canvas.getContext('2d');
        this.particles = [];
        this.symbols = ['○', '●', '+', '☊', '☁']; // Simple symbols repr cells/smoke
        this.width = 0;
        this.height = 0;
        this.animationId = null;

        this.resize = this.resize.bind(this);
        this.animate = this.animate.bind(this);
        
        this.init();
    }

    init() {
        window.addEventListener('resize', this.resize);
        this.resize();
        this.createParticles(30);
        this.animate();
    }

    resize() {
        this.width = this.canvas.width = window.innerWidth;
        this.height = this.canvas.height = window.innerHeight;
    }

    createParticles(count) {
        this.particles = [];
        for (let i = 0; i < count; i++) {
            this.particles.push({
                x: Math.random() * this.width,
                y: Math.random() * this.height,
                size: Math.random() * 15 + 5,
                speedY: Math.random() * 0.5 + 0.1,
                symbol: this.symbols[Math.floor(Math.random() * this.symbols.length)],
                opacity: Math.random() * 0.15 + 0.05
            });
        }
    }

    animate() {
        this.ctx.clearRect(0, 0, this.width, this.height);
        this.particles.forEach(p => {
            p.y -= p.speedY;
            if (p.y < -50) p.y = this.height + 50;
            this.ctx.fillStyle = `rgba(148, 163, 184, ${p.opacity})`;
            this.ctx.font = `${p.size}px 'Plus Jakarta Sans'`;
            this.ctx.fillText(p.symbol, p.x, p.y);
        });
        this.animationId = requestAnimationFrame(this.animate);
    }
}

/**
 * @class LessonController
 * @description Central logic for slides.
 */
class LessonController {
    constructor(slides) {
        this.slides = slides;
        this.index = 0;
        this.container = document.getElementById('slide-viewer');
        this.progressBar = document.getElementById('progress-bar');
        this.btnPrev = document.getElementById('btn-prev');
        this.btnNext = document.getElementById('btn-next');
        this.currentCleanup = null;
        this.init();
    }

    init() {
        new BackgroundAnimation('bg-canvas');
        this.btnPrev.addEventListener('click', () => this.prev());
        this.btnNext.addEventListener('click', () => this.next());
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') this.next();
            if (e.key === 'ArrowLeft') this.prev();
        });

        this.render();
    }

    render() {
        if (this.currentCleanup) {
            this.currentCleanup();
            this.currentCleanup = null;
        }

        const slide = this.slides[this.index];
        this.container.innerHTML = slide.template();
        this.container.scrollTop = 0; 

        this.progressBar.style.width = `${((this.index + 1) / this.slides.length) * 100}%`;
        this.btnPrev.disabled = this.index === 0;
        this.btnNext.disabled = this.index === this.slides.length - 1;

        if (window.MathJax) MathJax.typesetPromise([this.container]);

        requestAnimationFrame(() => {
            if (slide.script) {
                this.currentCleanup = slide.script(this.container);
            }
        });
    }

    next() {
        if (this.index < this.slides.length - 1) {
            this.index++;
            this.render();
        }
    }

    prev() {
        if (this.index > 0) {
            this.index--;
            this.render();
        }
    }
}

/**
 * SLIDE DATA
 */
const slides = [
    // SLIDE 1: Title
    {
        template: () => `
            <div style="text-align: center; margin-top: 5vh;" class="anim-enter">
                <i class="fa-solid fa-child-reaching" style="font-size: 6rem; color: var(--primary); margin-bottom: 2rem; filter: drop-shadow(0 0 30px rgba(139,92,246,0.6));"></i>
                <h1 style="color:white; margin-bottom: 0.5rem;">Growth, Development & Health</h1>
                <p style="font-size: 1.5rem; color: var(--accent); font-weight: 700; letter-spacing: 2px; text-transform: uppercase;">Unit 7.3</p>
                
                <div class="grid-3 delay-1 anim-enter" style="margin-top: 4rem; text-align: left;">
                    <div class="glass-card">
                        <i class="fa-solid fa-arrow-up-right-dots" style="font-size: 2.5rem; color: var(--warning); margin-bottom: 1rem;"></i>
                        <h3>Grow</h3>
                        <p>How do we get from one cell to trillions?</p>
                    </div>
                    <div class="glass-card">
                        <i class="fa-solid fa-brain" style="font-size: 2.5rem; color: var(--accent); margin-bottom: 1rem;"></i>
                        <h3>Develop</h3>
                        <p>How do our bodies change and become complex?</p>
                    </div>
                    <div class="glass-card">
                        <i class="fa-solid fa-heart-pulse" style="font-size: 2.5rem; color: var(--primary); margin-bottom: 1rem;"></i>
                        <h3>Health</h3>
                        <p>The impact of diet, exercise, and smoking.</p>
                    </div>
                </div>
            </div>
        `
    },

    // SLIDE 2: Hook (From One Cell)
    {
        template: () => `
            <div class="anim-enter">
                <div style="display:flex; align-items:center; gap:1rem; margin-bottom: 1.5rem;">
                    <div class="tag" style="background:var(--warning); color:black;">The Hook</div>
                    <h2>The Impossible Journey</h2>
                </div>
                
                <div class="grid-2">
                    <div class="glass-card delay-1 anim-enter" style="display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
                        <div style="width:100%; max-width:400px; aspect-ratio:16/9; border-radius:12px; overflow:hidden; border:2px solid rgba(255,255,255,0.1); margin-bottom:1rem;">
                            <video autoplay loop muted playsinline style="width:100%; height:100%; object-fit:cover;">
                                <source src="Cell_Division_Mitosis.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <p style="margin-top:0.5rem;">Every person on Earth began as a <strong class="highlight-accent">Single Cell</strong>.</p>
                    </div>

                    <div class="delay-2 anim-enter">
                        <div class="pedagogical-note note-task">
                            <div class="pedagogical-badge"><i class="fa-solid fa-comments"></i> Discuss</div>
                            <p style="font-size:1.4rem;">How does <strong>one</strong> tiny cell become a human composed of <strong>37 trillion</strong> cells?</p>
                            <hr style="border:0; border-top:1px solid rgba(255,255,255,0.1); margin:1rem 0;">
                            <p>Challenge Question:</p>
                            <p style="font-size: 1.2rem; color: var(--primary); font-weight: bold;">How many times does that single cell need to divide to make a fully grown human?</p>
                        </div>
                        <div class="reveal-card" id="hook-reveal">
                            <div class="pre-reveal">
                                <i class="fa-solid fa-question reveal-icon"></i>
                                <h3>Click for Answer</h3>
                            </div>
                            <div class="reveal-content">
                                <i class="fa-solid fa-clone reveal-icon" style="color:var(--primary)"></i>
                                <p><strong>Cell Division!</strong></p>
                                <p>One cell divides into two. Two into four. And so on.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `,
        script: (container) => {
            const card = container.querySelector('#hook-reveal');
            const handler = () => {
                card.classList.add('revealed');
                card.querySelector('.reveal-content').style.display = 'block';
                card.querySelector('.pre-reveal').style.display = 'none';
            };
            card.addEventListener('click', handler);
            return () => card.removeEventListener('click', handler);
        }
    },

    // SLIDE 3: Investigation (Virtual Lab) - MOVED HERE
    {
        template: () => `
            <div class="anim-enter">
                <h2>Virtual Lab: The Power of Division</h2>
                <p>Investigate how fast an organism can grow just by doubling.</p>
                
                <div class="grid-2">
                    <div class="glass-card delay-1 anim-enter" style="position:relative; height:400px; padding:0; overflow:hidden;">
                        <canvas id="mitosis-canvas" width="600" height="400" style="width:100%; height:100%; cursor:crosshair;"></canvas>
                        
                        <!-- HUD -->
                        <div style="position:absolute; bottom:20px; left:20px; pointer-events:none; display: flex; gap: 2rem;">
                            <div>
                                <h1 id="cell-count-display" style="font-size:3rem; text-shadow:0 2px 10px rgba(0,0,0,0.8); line-height: 1;">1</h1>
                                <p style="font-size: 0.9rem;">Cells</p>
                            </div>
                            <div>
                                <h1 id="division-count-display" style="font-size:3rem; text-shadow:0 2px 10px rgba(0,0,0,0.8); line-height: 1; color: var(--primary);">0</h1>
                                <p style="font-size: 0.9rem;">Divisions (Clicks)</p>
                            </div>
                        </div>

                        <div id="click-hint" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); pointer-events:none; background:rgba(0,0,0,0.6); padding:1rem; border-radius:12px;">
                            <i class="fa-solid fa-computer-mouse"></i> Click to Divide
                        </div>
                    </div>

                    <div class="delay-2 anim-enter">
                         <div class="pedagogical-note note-task">
                            <div class="pedagogical-badge"><i class="fa-solid fa-eye"></i> Instructions</div>
                            <ol style="margin-left:1.5rem;">
                                <li>Click the screen to trigger a round of <strong>Cell Division</strong>.</li>
                                <li>Notice: Does the number go 1, 2, 3? Or 1, 2, 4?</li>
                            </ol>
                        </div>

                        <div class="glass-card">
                            <h3>Observations</h3>
                            <p>To make a human (37,000,000,000,000 cells), how many clicks would you need?</p>
                            
                            <button id="reveal-divisions" class="btn-action" style="margin-top:1.5rem; width:100%;">Reveal Answer</button>
                            
                            <div id="division-answer" style="display:none; margin-top:1rem; background: rgba(139, 92, 246, 0.2); padding: 1rem; border-radius: 8px;">
                                <p><strong>Surprise!</strong></p>
                                <p>It only takes about <strong class="highlight-accent">46 divisions</strong> to reach over 70 trillion cells!</p>
                                <p style="font-size: 0.9rem; margin-top: 0.5rem;">Exponential growth is powerful.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `,
        script: (container) => {
            const canvas = container.querySelector('#mitosis-canvas');
            const ctx = canvas.getContext('2d');
            const countDisplay = container.querySelector('#cell-count-display');
            const divisionDisplay = container.querySelector('#division-count-display');
            const hint = container.querySelector('#click-hint');
            const btnReveal = container.querySelector('#reveal-divisions');
            const answerBox = container.querySelector('#division-answer');
            
            let cells = [{x: canvas.width/2, y: canvas.height/2, r: 20, targetX: canvas.width/2, targetY: canvas.height/2}];
            let animId;
            let divisions = 0;

            const draw = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Update and Draw
                cells.forEach(cell => {
                    // Ease to target position
                    cell.x += (cell.targetX - cell.x) * 0.1;
                    cell.y += (cell.targetY - cell.y) * 0.1;
                    
                    ctx.beginPath();
                    ctx.arc(cell.x, cell.y, cell.r, 0, Math.PI * 2);
                    ctx.fillStyle = '#8b5cf6';
                    ctx.fill();
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // Nucleus
                    ctx.beginPath();
                    ctx.arc(cell.x, cell.y, cell.r/3, 0, Math.PI * 2);
                    ctx.fillStyle = '#1e293b';
                    ctx.fill();
                });
                
                animId = requestAnimationFrame(draw);
            };

            const divide = () => {
                if (cells.length > 500) return; // Cap for performance
                hint.style.display = 'none';
                divisions++;
                divisionDisplay.innerText = divisions;
                
                const newCells = [];
                cells.forEach(cell => {
                    // Create two new cells slightly offset
                    const offset = cell.r * 1.5;
                    // Jitter targets
                    const tX1 = Math.max(20, Math.min(canvas.width - 20, cell.x - offset + (Math.random()*40-20)));
                    const tY1 = Math.max(20, Math.min(canvas.height - 20, cell.y - offset + (Math.random()*40-20)));
                    
                    const tX2 = Math.max(20, Math.min(canvas.width - 20, cell.x + offset + (Math.random()*40-20)));
                    const tY2 = Math.max(20, Math.min(canvas.height - 20, cell.y + offset + (Math.random()*40-20)));

                    newCells.push({x: cell.x, y: cell.y, r: Math.max(5, cell.r * 0.9), targetX: tX1, targetY: tY1});
                    newCells.push({x: cell.x, y: cell.y, r: Math.max(5, cell.r * 0.9), targetX: tX2, targetY: tY2});
                });
                
                cells = newCells;
                countDisplay.innerText = cells.length;
            };

            canvas.addEventListener('mousedown', divide);
            
            btnReveal.addEventListener('click', () => {
                answerBox.style.display = 'block';
                btnReveal.style.display = 'none';
            });

            draw();

            return () => {
                cancelAnimationFrame(animId);
            };
        }
    },

    // SLIDE 4: Theory - Growth vs Development
    {
        template: () => `
            <div class="anim-enter">
                <h2>Growth vs. Development</h2>
                <p>These two words mean different things in biology.</p>

                <div class="grid-2">
                    <div class="delay-1 anim-enter">
                        <div class="pedagogical-note note-write">
                            <div class="pedagogical-badge"><i class="fa-solid fa-pencil"></i> Definition</div>
                            <h3 class="highlight-primary">Growth</h3>
                            <p>Growth is an increase in <strong class="highlight-accent">size</strong>.</p>
                            <p>This happens because cells divide to make <strong>more cells</strong>, or existing cells get bigger.</p>
                            <div style="margin-top:1rem; text-align:center;">
                                <i class="fa-solid fa-circle-dot" style="font-size:1.5rem;"></i>
                                <i class="fa-solid fa-arrow-right"></i>
                                <i class="fa-solid fa-circle-dot" style="font-size:1.5rem;"></i>
                                <i class="fa-solid fa-circle-dot" style="font-size:1.5rem;"></i>
                            </div>
                        </div>
                        <div class="glass-card" style="margin-top:1rem;">
                            <h4>The Embryo</h4>
                            <p>A ball of cells formed from the first cell. It grows into a baby.</p>
                        </div>
                    </div>

                    <div class="delay-2 anim-enter">
                        <div class="pedagogical-note note-write">
                            <div class="pedagogical-badge"><i class="fa-solid fa-pencil"></i> Definition</div>
                            <h3 class="highlight-warn">Development</h3>
                            <p>Development is an increase in <strong class="highlight-accent">complexity</strong>.</p>
                            <p>Cells become specialized (tissues, organs) and the person learns new skills (walking, talking).</p>
                        </div>
                        
                        <div class="glass-card" style="margin-top:1rem;">
                            <h4>Stages of Life</h4>
                            <div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-top:1rem; text-align:center;">
                                <div><i class="fa-solid fa-baby"></i><br>Baby</div>
                                <div><i class="fa-solid fa-child"></i><br>Toddler</div>
                                <div><i class="fa-solid fa-child-reaching"></i><br>Child</div>
                                <div><i class="fa-solid fa-user"></i><br>Adult</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `
    },

    // SLIDE 5: Health - Diet & Exercise
    {
        template: () => `
            <div class="anim-enter">
                <h2>Keeping Healthy</h2>
                <p>Growth requires fuel and maintenance.</p>
                
                <div class="grid-2">
                    <div class="glass-card delay-1 anim-enter">
                        <h3><i class="fa-solid fa-utensils"></i> Diet</h3>
                        <p style="margin-bottom:1rem;">A growing body is a construction site.</p>
                        
                        <div class="quiz-option" style="cursor:default; background:rgba(255,255,255,0.05);">
                            <strong class="highlight-primary">Protein</strong>
                            <p style="font-size:0.9rem;">Essential for making new cells.</p>
                        </div>
                        <div class="quiz-option" style="cursor:default; background:rgba(255,255,255,0.05);">
                            <strong class="highlight-warn">Energy (Carbs/Fats)</strong>
                            <p style="font-size:0.9rem;">Fuel for cell division and movement.</p>
                        </div>
                        <div class="pedagogical-note note-theory" style="margin-top:1rem; padding:1rem;">
                            <div class="pedagogical-badge"><i class="fa-solid fa-triangle-exclamation"></i> Warning</div>
                            <p>Storing too much energy results in fat.</p>
                        </div>
                    </div>

                    <div class="glass-card delay-2 anim-enter">
                        <h3><i class="fa-solid fa-person-running"></i> Exercise</h3>
                        <p>Why move?</p>
                        <ul style="margin-top:1rem; list-style:none;">
                            <li style="margin-bottom:1rem;"><i class="fa-solid fa-check highlight-accent"></i> Uses up energy (prevents excess fat).</li>
                            <li style="margin-bottom:1rem;"><i class="fa-solid fa-check highlight-accent"></i> Strengthens heart & muscles.</li>
                            <li><i class="fa-solid fa-check highlight-accent"></i> Mental Health: Makes you feel cheerful.</li>
                        </ul>
                    </div>
                </div>
            </div>
        `
    },

    // SLIDE 6: Smoking - The Villains
    {
        template: () => `
            <div class="anim-enter">
                <h2>Smoking: The Chemical Villains</h2>
                <p>Tobacco smoke contains harmful substances. Click to identify them.</p>

                <div class="grid-2 delay-1 anim-enter">
                    <!-- Nicotine -->
                    <div class="reveal-card" role="button" tabindex="0">
                        <div class="pre-reveal">
                            <i class="fa-solid fa-bolt reveal-icon"></i>
                            <h3>The Addictive One</h3>
                        </div>
                        <div class="reveal-content">
                            <strong class="highlight-primary" style="font-size:1.5rem;">Nicotine</strong>
                            <p>An addictive stimulant.</p>
                            <p>It narrows blood vessels, making the heart work harder. Causes heart disease.</p>
                        </div>
                    </div>

                    <!-- Tar -->
                    <div class="reveal-card" role="button" tabindex="0">
                        <div class="pre-reveal">
                            <i class="fa-solid fa-road reveal-icon"></i>
                            <h3>The Sticky One</h3>
                        </div>
                        <div class="reveal-content">
                            <strong class="highlight-primary" style="font-size:1.5rem;">Tar</strong>
                            <p>A mixture of dark, sticky chemicals.</p>
                            <p>Causes <strong class="highlight-danger">Cancer</strong> (cells dividing out of control).</p>
                        </div>
                    </div>

                    <!-- Particulates -->
                    <div class="reveal-card" role="button" tabindex="0">
                        <div class="pre-reveal">
                            <i class="fa-solid fa-virus reveal-icon"></i>
                            <h3>The Tiny Solids</h3>
                        </div>
                        <div class="reveal-content">
                            <strong class="highlight-primary" style="font-size:1.5rem;">Particulates</strong>
                            <p>Tiny particles of carbon.</p>
                            <p>They get trapped in the lungs and break down the <strong>Alveoli</strong> (air sacs).</p>
                        </div>
                    </div>

                    <!-- CO -->
                    <div class="reveal-card" role="button" tabindex="0">
                        <div class="pre-reveal">
                            <i class="fa-solid fa-cloud reveal-icon"></i>
                            <h3>The Poison Gas</h3>
                        </div>
                        <div class="reveal-content">
                            <strong class="highlight-primary" style="font-size:1.5rem;">Carbon Monoxide</strong>
                            <p>A poisonous gas.</p>
                            <p>Stops blood from carrying Oxygen.</p>
                        </div>
                    </div>
                </div>
            </div>
        `,
        script: (container) => {
            const cards = container.querySelectorAll('.reveal-card');
            cards.forEach(card => {
                card.addEventListener('click', () => {
                    card.classList.add('revealed');
                    card.querySelector('.reveal-content').style.display = 'block';
                    card.querySelector('.pre-reveal').style.display = 'none';
                });
            });
            return () => {};
        }
    },

    // SLIDE 7: Carbon Monoxide Deep Dive
    {
        template: () => `
            <div class="anim-enter">
                <h2>The Silent Thief: Carbon Monoxide</h2>
                <div class="grid-2">
                    <div class="pedagogical-note note-theory delay-1 anim-enter">
                        <div class="pedagogical-badge"><i class="fa-solid fa-flask"></i> Mechanism</div>
                        <p><strong>Haemoglobin</strong> in red blood cells carries Oxygen.</p>
                        <p style="margin-top:1rem;">Carbon Monoxide (CO) binds to haemoglobin <strong class="highlight-danger">better</strong> than Oxygen does.</p>
                        <p>It "steals the seats" on the red blood cells. This means less oxygen reaches the body cells for respiration.</p>
                    </div>

                    <div class="glass-card delay-2 anim-enter" style="text-align:center;">
                        <h3>Blood Cell Simulation</h3>
                        <svg viewBox="0 0 200 100" style="width:100%; height:150px; background:rgba(0,0,0,0.2); border-radius:12px; margin: 1rem 0;">
                            <!-- Blood Cell -->
                            <circle cx="100" cy="50" r="40" fill="#ef4444" stroke="#7f1d1d" stroke-width="3" />
                            <text x="100" y="55" font-size="10" fill="white" text-anchor="middle" font-family="sans-serif">RBC</text>
                            
                            <!-- Oxygen Slots -->
                            <circle id="slot-1" cx="80" cy="40" r="8" fill="white" />
                            <circle id="slot-2" cx="120" cy="40" r="8" fill="white" />
                            <circle id="slot-3" cx="80" cy="65" r="8" fill="white" />
                            <circle id="slot-4" cx="120" cy="65" r="8" fill="white" />
                        </svg>

                        <div style="display:flex; justify-content:center; gap:1rem;">
                            <button id="btn-breathe-air" class="btn-action" style="font-size:0.9rem;">Breathe Air (O₂)</button>
                            <button id="btn-breathe-smoke" class="btn-action" style="font-size:0.9rem; background:var(--text-dim);">Breathe Smoke (CO)</button>
                        </div>
                        <p id="status-text" style="margin-top:1rem; height:1.5rem;">Carrying Oxygen</p>
                    </div>
                </div>
            </div>
        `,
        script: (container) => {
            const slots = [1, 2, 3, 4].map(i => container.querySelector(`#slot-${i}`));
            const btnAir = container.querySelector('#btn-breathe-air');
            const btnSmoke = container.querySelector('#btn-breathe-smoke');
            const status = container.querySelector('#status-text');

            btnAir.addEventListener('click', () => {
                slots.forEach(s => {
                    s.setAttribute('fill', 'white'); // Oxygen
                });
                status.innerText = "Carrying Oxygen (Energy High)";
                status.style.color = "white";
            });

            btnSmoke.addEventListener('click', () => {
                slots.forEach(s => {
                    s.setAttribute('fill', '#1e293b'); // CO (Black/Dark)
                });
                status.innerText = "Blocked by Carbon Monoxide (Energy Low)";
                status.style.color = "var(--danger)";
            });

            return () => {};
        }
    },

    // SLIDE 8: Data Analysis (The Graph)
    {
        template: () => `
            <div class="anim-enter">
                <h2>Data Analysis: Smoking & Pregnancy</h2>
                <div class="pedagogical-note note-theory delay-1 anim-enter" style="margin-bottom: 2rem;">
                    <div class="pedagogical-badge"><i class="fa-solid fa-baby-carriage"></i> Low Birthweight</div>
                    <p>Smoking during pregnancy reduces the oxygen reaching the baby because of Carbon Monoxide.</p>
                    <p>This prevents the baby from respiring and growing fully, leading to <strong>Low Birthweight</strong>. Low birthweight babies are more at risk of infection and complications.</p>
                </div>
                
                <div class="grid-2">
                    <div class="glass-card delay-1 anim-enter">
                        <div class="chart-container">
                            <div class="chart-label" style="left:20%">None</div>
                            <div class="chart-bar" style="height:0%; background:var(--accent)" data-height="40%" data-val="4%"></div>
                            
                            <div class="chart-label" style="left:50%">Less than 15</div>
                            <div class="chart-bar" style="height:0%; background:var(--warning)" data-height="80%" data-val="8%"></div>

                            <div class="chart-label" style="left:80%">15 or more</div>
                            <div class="chart-bar" style="height:0%; background:var(--danger)" data-height="95%" data-val="9.5%"></div>
                        </div>
                        <p style="text-align:center; font-size:0.9rem; margin-top:2rem;">Number of cigarettes smoked per day</p>
                    </div>

                    <div class="delay-2 anim-enter">
                        <div class="pedagogical-note note-task">
                            <div class="pedagogical-badge"><i class="fa-solid fa-calculator"></i> Maths Check</div>
                            <p><strong>Question 1:</strong> Describe the trend shown in the bar chart.</p>
                            <p><strong>Question 2:</strong> A non-smoking mother has a 4% chance of a low birthweight baby. How much does the risk increase if she smokes 15+ cigarettes?</p>
                            
                            <button id="reveal-maths" class="btn-action" style="margin-top:1rem;">Check Answer</button>
                            
                            <div id="maths-answer" style="display:none; margin-top:1rem; border-top:1px solid rgba(255,255,255,0.2); padding-top:1rem;">
                                <p><strong class="highlight-accent">Trend:</strong> As the number of cigarettes increases, the percentage of low birthweight babies increases (Positive correlation).</p>
                                <p><strong class="highlight-accent">Calculation:</strong> 9.5% - 4% = <strong>5.5% increase</strong> (The risk more than doubles).</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `,
        script: (container) => {
            // Animate Chart
            setTimeout(() => {
                const bars = container.querySelectorAll('.chart-bar');
                bars.forEach(bar => {
                    bar.style.height = bar.dataset.height;
                });
            }, 500);

            // Reveal Logic
            const btn = container.querySelector('#reveal-maths');
            const ans = container.querySelector('#maths-answer');
            btn.addEventListener('click', () => {
                ans.style.display = 'block';
                btn.style.display = 'none';
            });

            return () => {};
        }
    },

    // SLIDE 9: Assessment Quiz
    {
        template: () => `
            <div class="anim-enter">
                <h2>Knowledge Check</h2>
                <div class="grid-2">
                    <div class="delay-1 anim-enter">
                        <div class="pedagogical-note note-success" style="margin-top:0;">
                            <div class="pedagogical-badge"><i class="fa-solid fa-trophy"></i> Learning Objectives</div>
                            <ul style="margin-top:1rem;">
                                <li>I can describe how organisms grow (cell division).</li>
                                <li>I can explain the difference between growth and development.</li>
                                <li>I can explain how smoking damages health (Cancer, Heart Disease, Low Oxygen).</li>
                            </ul>
                        </div>

                        <!-- Final Task/Question -->
                        <div class="glass-card" style="margin-top:2rem;">
                            <h3><i class="fa-solid fa-message"></i> Final Thought</h3>
                            <p>Why do you think the government tries to reduce smoking?</p>
                            <button class="btn-action" id="reveal-final" style="margin-top:1rem; font-size:0.9rem;">Show Reason</button>
                            <p id="final-answer" style="display:none; margin-top:1rem; color:var(--text-light); font-style:italic;">To reduce the burden on hospitals (treating cancer/heart disease) and improve the general health of the population.</p>
                        </div>
                    </div>

                    <div class="delay-2 anim-enter">
                        <div class="glass-card">
                            <h3><i class="fa-solid fa-list-check"></i> Select the Correct Answers</h3>
                            
                            <div class="quiz-option" role="button" tabindex="0" data-correct="false">
                                1. Growth means becoming more complex.
                            </div>
                            <div class="quiz-option" role="button" tabindex="0" data-correct="true">
                                2. Nicotine is the addictive substance in tobacco.
                            </div>
                            <div class="quiz-option" role="button" tabindex="0" data-correct="true">
                                3. Carbon monoxide stops blood carrying oxygen.
                            </div>
                            <div class="quiz-option" role="button" tabindex="0" data-correct="false">
                                4. Tar is a gas that makes you alert.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `,
        script: (container) => {
            const options = container.querySelectorAll('.quiz-option');
            const checkOption = (opt) => {
                const isCorrect = opt.dataset.correct === "true";
                if (isCorrect) {
                    opt.classList.add('correct');
                    opt.innerHTML += ' <i class="fa-solid fa-check" style="color:var(--accent)"></i>';
                } else {
                    opt.classList.add('wrong');
                    opt.style.opacity = '0.7';
                    opt.innerHTML += ' <i class="fa-solid fa-xmark" style="color:var(--danger)"></i>';
                }
                opt.style.pointerEvents = 'none';
            };

            options.forEach(opt => {
                opt.addEventListener('click', () => checkOption(opt));
            });

            // Final Reveal
            const btnFinal = container.querySelector('#reveal-final');
            const ansFinal = container.querySelector('#final-answer');
            btnFinal.addEventListener('click', () => {
                ansFinal.style.display = 'block';
                btnFinal.style.display = 'none';
            });

            return () => {};
        }
    },

    // SLIDE 10: Video Resource
    {
        template: () => `
            <div class="anim-enter" style="text-align:center; height: 100%; display: flex; flex-direction: column; justify-content: center;">
                <h2>Watch & Review</h2>
                <div class="glass-card delay-1 anim-enter" style="padding: 10px; display: inline-block; width: 100%; max-width: 800px; aspect-ratio: 16/9; margin: 0 auto;">
                    <iframe width="100%" height="100%" src="https://www.youtube.com/embed/Y18Vz51Nkos" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen style="border-radius: 12px;"></iframe>
                </div>
                <div class="delay-2 anim-enter" style="margin-top: 2rem;">
                     <div class="pedagogical-note note-write" style="display:inline-block; text-align:left;">
                        <div class="pedagogical-badge"><i class="fa-solid fa-video"></i> Video Summary</div>
                        <p>Watch how a single cell divides and specializes to form a human body.</p>
                    </div>
                </div>
            </div>
        `
    }
];

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    new LessonController(slides);
});

</script>
</body>
</html>
